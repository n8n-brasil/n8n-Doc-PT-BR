---
sidebar_position: 2
title: Split In Batches
description: Divida dados em lotes para processamento eficiente em workflows n8n
keywords: [n8n, split, batches, lotes, processamento, dados, performance]
---

#ionicicon-namecode-slash-outline-style-fontsize-24px color: '#cor-ea4b71-split-in Batches Node

O **Split In Batches Node** é essencial para processar grandes volumes de dados de forma eficiente, dividindo-os em lotes menores que podem ser processados sequencialmente ou em paralelo.

#ionicicon-namechevron-forward-outline-style-fontsize-24px color: '#cor-ea4b71-conceito-principal

**Split In Batches = "Dividir Dados em Lotes"**

O Split In Batches Node é uma **AÇÃO** que:

- **Divide** grandes conjuntos de dados em lotes menores
- **Permite** processamento eficiente de grandes volumes
- **Evita** timeouts e problemas de memória
- **Facilita** operações em paralelo

> **💡 Dica:** Use este node quando tiver muitos dados para processar ou quando APIs têm limites de rate limiting.

#ionicicon-namesparkles-outline-style-fontsize-24px color: '#cor-ea4b71-configuraes-principais

#id-1-batch-size-nmero de itens por lote (ex: 100, 500, 1000)
```

#id-2-options-wait-between Batches - Aguardar entre lotes
Batch Size - Tamanho do lote
Reset - Reiniciar contador de lotes
```

#id-3-wait-between-batches
Delay (ms) - Tempo de espera entre lotes
```

#ionicicon-namebulb-outline-style-fontsize-24px color: '#cor-ea4b71-exemplos-prticos

#exemplo-1-processar-lista-de Emails**

**Entrada (1000 emails):**

```json
[
  {"email": "joao@email.com", "nome": "João"},
  {"email": "maria@email.com", "nome": "Maria"},
  // ... 998 emails mais
]
```

**Configuração:**

```
Batch Size: 100
Wait Between Batches: 1000ms (1 segundo)
```

**Resultado:**

- **Lote 1**: Emails 1-100
- **Lote 2**: Emails 101-200
- **Lote 3**: Emails 201-300
- ...
- **Lote 10**: Emails 901-1000

#exemplo-2-enviar-notificaes-em Lotes**

**Workflow:**

```
Manual Trigger → Split In Batches → HTTP Request → Email
```

**Configuração Split In Batches:**

```
Batch Size: 50
Wait Between Batches: 2000ms
```

**Configuração HTTP Request (por lote):**

```
Method: POST
URL: https://api.notificacao.com/batch
Body: {{ JSON.stringify($json) }}
```

#exemplo-3-processar-produtos-de E-commerce**

**Entrada (5000 produtos):**

```json
[
  {"id": 1, "nome": "Produto 1", "preco": 100},
  {"id": 2, "nome": "Produto 2", "preco": 200},
  // ... 4998 produtos mais
]
```

**Configuração:**

```
Batch Size: 200
Wait Between Batches: 500ms
```

**Processamento por lote:**

- Atualizar preços
- Sincronizar estoque
- Enviar para API externa

#ionicicon-namesettings-outline-style-fontsize-24px color: '#cor-ea4b71-casos-de Uso Comuns**

#id-1-rate-limiting-de-apis

**Problema:** API tem limite de 100 requisições por minuto
**Solução:** Dividir em lotes de 100 com delay de 60 segundos

```javascript
// Configuração
Batch Size: 100
Wait Between Batches: 60000ms (60 segundos)
```

#id-2-processamento-de-arquivos-grandes

**Problema:** Arquivo CSV com 10.000 linhas
**Solução:** Processar em lotes de 500 linhas

```javascript
// Configuração
Batch Size: 500
Wait Between Batches: 1000ms
```

#id-3-envio-de-emails-em Massa**

**Problema:** Enviar 5.000 emails sem sobrecarregar servidor
**Solução:** Enviar em lotes de 100 com delay

```javascript
// Configuração
Batch Size: 100
Wait Between Batches: 5000ms (5 segundos)
```

#id-4-sincronizao-de-dados-problema Sincronizar 20.000 registros com sistema externo
**Solução:** Processar em lotes de 1.000

```javascript
// Configuração
Batch Size: 1000
Wait Between Batches: 2000ms
```

#ionicicon-namecode-slash-outline-style-fontsize-24px color: '#cor-ea4b71-configuraes-avanadas

#wait-between-batches-delay-fixo

```
Wait Between Batches: 1000ms
```

**Delay Dinâmico (usando expressão):**

```
Wait Between Batches: {{ $json.batch_number * 1000 }}ms
```

**Delay Baseado em Rate Limiting:**

```
Wait Between Batches: {{ Math.ceil(60000 / 100) }}ms  // 100 req/min
```

#batch-size-dinmico-baseado-no tipo de dados:**

```
Batch Size: {{ $json.tipo === 'email' ? 100 : 500 }}
```

**Baseado na API:**

```
Batch Size: {{ $json.api_limit || 100 }}
```

**Baseado na performance:**

```
Batch Size: {{ $json.performance === 'high' ? 1000 : 100 }}
```

#ionicicon-namespeedometer-outline-style-fontsize-24px color: '#cor-ea4b71-otimizao-de Performance**

#escolhendo-o-tamanho-do-lote

| Cenário | Tamanho Recomendado | Justificativa |
|---------|-------------------|---------------|
| **APIs com Rate Limiting** | 50-100 | Evitar exceder limites |
| **Processamento Local** | 500-1000 | Máximo de eficiência |
| **Envio de Emails** | 100-200 | Evitar spam filters |
| **Sincronização** | 1000-2000 | Máxima velocidade |
| **Arquivos Grandes** | 500-1000 | Balance entre memória e velocidade |

#configurao-de-delays-tipo de Operação | Delay Recomendado | Razão |
|------------------|-------------------|-------|
| **APIs Externas** | 1000-5000ms | Rate limiting |
| **Envio de Emails** | 2000-10000ms | Evitar spam |
| **Processamento Local** | 100-500ms | Otimização |
| **Sincronização** | 500-2000ms | Balance |

#monitoramento-de-performance-javascript Adicionar métricas ao lote
{
  "batch_number": 1,
  "batch_size": 100,
  "total_items": 1000,
  "processed_items": 100,
  "start_time": "2024-01-15T10:00:00Z",
  "estimated_completion": "2024-01-15T10:10:00Z"
}
```

#ionicicon-nameshield-checkmark-outline-style-fontsize-24px color: '#cor-ea4b71-tratamento-de Erros**

#erro-em-um-lote-configurao de Retry:**

```
Max Tries: 3
Wait Between Tries: 5000ms
```

**Tratamento de Erro:**

```javascript
// No node seguinte, verificar se houve erro
if ($json.error) {
  // Log do erro
  console.log('Erro no lote:', $json.batch_number, $json.error);
  
  // Continuar processamento
  return { json: { ...$json, status: 'error_handled' } };
}
```

#recuperao-de-falhas-workflow-com Error Handling:**

```
Split In Batches → HTTP Request → Error Trigger → Log Error → Continue
```

**Configuração Error Trigger:**

```
Continue on Fail: true
```

#ionicicon-namebulb-outline-style-fontsize-24px color: '#cor-ea4b71-exemplos-de Workflows**

#workflow-1-envio-de-newsletter

```
Manual Trigger → Split In Batches (100) → Email Node → Wait (2s) → Continue
```

**Configurações:**

- **Split In Batches**: 100 emails por lote
- **Wait**: 2 segundos entre lotes
- **Email Node**: Template personalizado

#workflow-2-sincronizao-de-produtos

```
Schedule Trigger → HTTP Request (buscar produtos) → Split In Batches (500) → HTTP Request (atualizar) → Wait (1s) → Continue
```

**Configurações:**

- **Split In Batches**: 500 produtos por lote
- **Wait**: 1 segundo entre lotes
- **HTTP Request**: API de atualização

#workflow-3-processamento-de-arquivos

```
Webhook (upload arquivo) → CSV Parser → Split In Batches (1000) → Process Data → Wait (500ms) → Continue
```

**Configurações:**

- **Split In Batches**: 1000 linhas por lote
- **Wait**: 500ms entre lotes
- **Process Data**: Transformação de dados

#ionicicon-namewarning-outline-style-fontsize-24px color: '#cor-ea4b71-limitaes-e Considerações**

#limitaes-tcnicas-memria-cada lote é mantido em memória
- **Timeout**: Workflows têm timeout total
- **Rate Limiting**: APIs externas podem ter limites
- **Concorrência**: Processamento sequencial por padrão

#consideraes-de-design-tamanho do lote**: Balance entre performance e memória
- **Delays**: Evitar sobrecarregar sistemas externos
- **Error handling**: Tratar falhas em lotes individuais
- **Monitoramento**: Acompanhar progresso dos lotes

#boas-prticas-javascript Bom: Tamanho de lote apropriado
Batch Size: 100  // Para APIs com rate limiting

// ✅ Bom: Delay adequado
Wait Between Batches: 2000ms  // 2 segundos

// ❌ Evitar: Lotes muito grandes
Batch Size: 10000  // Pode causar timeout

// ❌ Evitar: Sem delay
Wait Between Batches: 0ms  // Pode sobrecarregar API
```

#ionicicon-namearrow-forward-circle-outline-style-fontsize-24px color: '#cor-ea4b71-prximos-passos

Agora que você entende o Split In Batches Node:

1. **[Set Node](./set)** - Para manipulação básica de dados
2. **[Aggregate Node](./aggregate)** - Para agregações e resumos
3. **[Code Node](../core-nodes/code)** - Para lógica customizada
4. **[IF Node](../logic-control/if)** - Para controle de fluxo

---

:::tip **Dica Pro**
Use **lotes menores** (50-100) para APIs com rate limiting e **lotes maiores** (500-1000) para processamento local.
:::

:::info **Performance**
O tamanho ideal do lote depende do seu caso de uso. Teste diferentes tamanhos para encontrar o ótimo.
:::

:::warning **Rate Limiting**
Sempre configure delays adequados para evitar exceder limites de APIs externas.
:::

---

**Links úteis:**

- [Documentação oficial do Split In Batches](https://docs.n8n.io/integrations/builtin/cluster-nodes/sub-nodes/n8n-nodes-langchain.splitinbatches/)
- [Set Node](./set) - Para manipulação de dados
- [Aggregate Node](./aggregate) - Para agregações
- [Code Node](../core-nodes/code) - Para lógica customizada

