---
sidebar_position: 1
title: Gerenciar Workflows Embarcados
description: Como gerenciar e controlar workflows em n8n embarcado
keywords: [n8n, embed, workflows, gerenciamento, controle, permissões]
---

import IonicIcon from '@site/src/components/IonicIcon';

<IonicIcon name="git-branch-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

## Gerenciar Workflows Embarcados

Este documento detalha como **gerenciar workflows em n8n embarcado**, incluindo controle de acesso granular, versionamento integrado, backup automático, sincronização com sistemas externos, auditoria de mudanças, e estratégias de governança que garantem controle total sobre automações criadas dentro do ambiente embarcado mantendo compliance e segurança empresarial.

<IonicIcon name="school-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

## API de Workflows

<IonicIcon name="git-branch-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

### Criar Novo Workflow

```bash
POST /api/v1/workflows
Content-Type: application/json

{
  "name": "Workflow de Teste",
  "active": false,
  "nodes": [...],
  "connections": {...}
}
```

<IonicIcon name="git-branch-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

### Atualizar Workflow

```bash
PUT /api/v1/workflows/{id}
```

<IonicIcon name="git-branch-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

### Excluir Workflow

```bash
DELETE /api/v1/workflows/{id}
```

<IonicIcon name="git-branch-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

### Ativar/Desativar Workflow

```bash
PATCH /api/v1/workflows/{id}
{
  "active": true
}
```

---

<IonicIcon name="document-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

## Execuções

<IonicIcon name="document-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

### Listar Execuções

```bash
GET /api/v1/executions
```

<IonicIcon name="document-text-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

### Exemplo de Response

```json
{
  "data": {
    "campo1": "valor1",
    "campo2": "valor2"
  }
}
```

<IonicIcon name="document-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

### Obter Detalhes da Execução

```bash
GET /api/v1/executions/{id}
```

<IonicIcon name="document-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

### Parar Execução em Andamento

```bash
POST /api/v1/executions/{id}/stop
```

---

<IonicIcon name="shield-checkmark-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

## Controle de Acesso e Permissões

### Sistema RBAC

O n8n implementa Role-Based Access Control (RBAC) para controle granular de acesso:

#### Roles Disponíveis

```javascript
// Roles padrão do n8n
const roles = {
  owner: {
    description: "Acesso total ao sistema",
    permissions: ["*"]
  },
  admin: {
    description: "Gerenciamento de usuários e configurações",
    permissions: [
      "user:read", "user:write",
      "workflow:read", "workflow:write",
      "credential:read", "credential:write"
    ]
  },
  editor: {
    description: "Criar e editar workflows",
    permissions: [
      "workflow:read", "workflow:write",
      "execution:read", "execution:write"
    ]
  },
  viewer: {
    description: "Apenas visualizar workflows",
    permissions: [
      "workflow:read",
      "execution:read"
    ]
  }
}
```

#### Permissões por Workflow

```javascript
// Configurar permissões específicas por workflow
{
  "workflowId": "abc123",
  "permissions": {
    "user1@empresa.com": ["read", "write"],
    "user2@empresa.com": ["read"],
    "group:marketing": ["read", "execute"]
  }
}
```

### Integração com Sistemas Externos

#### SAML/SSO

```yaml
N8N_SAML_ENABLED=true
N8N_SAML_ISSUER=https://seu-identity-provider.com
N8N_SAML_ENTRY_POINT=https://seu-identity-provider.com/sso
N8N_SAML_CERT=/path/to/certificate.pem
```

#### LDAP/Active Directory

```yaml
N8N_LDAP_ENABLED=true
N8N_LDAP_SERVER_URL=ldap://ldap.suaempresa.com:389
N8N_LDAP_BIND_DN=cn=admin,dc=suaempresa,dc=com
N8N_LDAP_BIND_PASSWORD=SUA_SENHA_LDAP_AQUI
N8N_LDAP_BASE_DN=dc=suaempresa,dc=com
```

---

<IonicIcon name="sparkles-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

## Versionamento e Controle de Versões

### Histórico de Versões

```json
{
  "workflowId": "abc123",
  "versions": [
    {
      "version": 5,
      "timestamp": "2024-01-15T10:30:00Z",
      "author": "usuario@empresa.com",
      "changes": "Adicionado node de validação",
      "active": true
    },
    {
      "version": 4,
      "timestamp": "2024-01-14T15:45:00Z",
      "author": "usuario@empresa.com",
      "changes": "Corrigido bug no webhook",
      "active": false
    }
  ]
}
```

### API de Versionamento

<IonicIcon name="git-branch-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

#### Listar Versões de um Workflow

```bash
GET /api/v1/workflows/{id}/versions
```

<IonicIcon name="document-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

#### Obter Versão Específica

```bash
GET /api/v1/workflows/{id}/versions/{version}
```

<IonicIcon name="document-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

#### Restaurar Versão Anterior

```bash
POST /api/v1/workflows/{id}/versions/{version}/restore
```

<IonicIcon name="document-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

#### Comparar Versões

```bash
GET /api/v1/workflows/{id}/versions/compare?from=3&to=5
```

### Documentação de Mudanças

#### Comentários de Versão

```javascript
// Adicionar comentário ao salvar
{
  "name": "Workflow de Vendas",
  "versionComment": "Adicionada validação de CPF e integração com CRM",
  "nodes": [...],
  "connections": {...}
}
```

#### Changelog Automático

<IonicIcon name="document-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

```bash
# Gerar changelog entre versões
curl -X GET "https://seu-n8n.com/api/v1/workflows/{id}/changelog?from=1&to=5" \
  -H "X-N8N-API-KEY: sua_api_key"
```

---

<IonicIcon name="sparkles-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

## Auditoria e Logs

### Logs de Atividade

#### Eventos Auditados

```javascript
// Tipos de eventos registrados
const auditEvents = {
  "workflow.created": "Workflow criado",
  "workflow.updated": "Workflow atualizado",
  "workflow.deleted": "Workflow excluído",
  "workflow.executed": "Workflow executado",
  "user.login": "Usuário fez login",
  "user.logout": "Usuário fez logout",
  "credential.accessed": "Credencial acessada",
  "permission.changed": "Permissão alterada"
}
```

### API de Auditoria

<IonicIcon name="document-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

```bash
# Obter logs de atividade
GET /api/v1/audit-logs?start=2024-01-01&end=2024-01-31
```

<IonicIcon name="person-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

### Alertas de Segurança

```javascript
{
  "securityAlerts": {
    "failedLogins": {
      "threshold": 5,
      "timeWindow": "15m",
      "action": "notify_admin"
    },
    "workflowDeletions": {
      "action": "notify_admin",
      "immediate": true
    },
    "unusualActivity": {
      "newLocation": true,
      "unusualHours": true,
      "action": "notify_user"
    }
  }
}
```

### Integração com Sistemas de Monitoramento

<IonicIcon name="git-network-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

```bash
# Webhook para alertas
POST /webhook/security-alerts
{
  "event": "workflow.deleted",
  "user": "usuario@empresa.com",
  "workflow": "Workflow Crítico",
  "timestamp": "2024-01-15T10:30:00Z",
  "ip": "SEU_IP_INTERNO00"
}
```

---

<IonicIcon name="chevron-forward-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

## Backup e Recovery Automático

### Script de Backup

```bash
#!/bin/bash

BACKUP_DIR="/backups/n8n"
API_KEY="sua_api_key"
N8N_URL="https://seu-n8n.com"
DATE=$(date +%Y%m%d_%H%M%S)

# Backup de workflows
curl -H "X-N8N-API-KEY: $API_KEY" \
  "$N8N_URL/api/v1/workflows" \
  | jq '.' > "$BACKUP_DIR/workflows_$DATE.json"

# Backup de credenciais
curl -H "X-N8N-API-KEY: $API_KEY" \
  "$N8N_URL/api/v1/credentials" \
  | jq '.' > "$BACKUP_DIR/credentials_$DATE.json"

# Criar arquivo compactado
tar -czf "$BACKUP_DIR/n8n_backup_$DATE.tar.gz" \
  "$BACKUP_DIR/workflows_$DATE.json" \
  "$BACKUP_DIR/credentials_$DATE.json"

# Limpar backups antigos (mais de 30 dias)
find $BACKUP_DIR -name "n8n_backup_*.tar.gz" -mtime +30 -delete

echo "Backup criado: $BACKUP_DIR/n8n_backup_$DATE.tar.gz"
```

### Cron Job para Backup

```bash
# Adicionar ao crontab
0 2 * * * /path/to/backup-script.sh
```

### Script de Restore

```bash
#!/bin/bash

API_KEY="sua_api_key"
N8N_URL="https://seu-n8n.com"

# Restaurar workflows
jq -c '.[]' workflows_*.json | while read workflow; do
  curl -X POST \
    -H "X-N8N-API-KEY: $API_KEY" \
    -H "Content-Type: application/json" \
    -d "$workflow" \
    "$N8N_URL/api/v1/workflows"
done

echo "Workflows restaurados com sucesso"
```

---

<IonicIcon name="git-network-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

## Sincronização com Sistemas Externos

### Webhook para Sincronização

```json
{
  "url": "https://sistema-externo.com/webhook/n8n",
  "method": "POST",
  "headers": {
    "Authorization": "Bearer token_externo",
    "Content-Type": "application/json"
  },
  "body": {
    "event": "workflow.updated",
    "workflow": {
      "id": "abc123",
      "name": "Workflow de Vendas",
      "version": 5,
      "active": true
    },
    "timestamp": "2024-01-15T10:30:00Z"
  }
}
```

### Integração com Git

#### Sincronização com Repositório

```bash
#!/bin/bash

WORKFLOW_DIR="/tmp/n8n-workflows"
GIT_REPO="https://github.com/empresa/n8n-workflows.git"
API_KEY="sua_api_key"
N8N_URL="https://seu-n8n.com"

# Baixar workflows
curl -H "X-N8N-API-KEY: $API_KEY" \
  "$N8N_URL/api/v1/workflows" \
  | jq '.' > "$WORKFLOW_DIR/workflows.json"

# Commit e push
git commit -m "Sync workflows $(date)"
git push origin main

echo "Workflows sincronizados com Git"
```

---

<IonicIcon name="chevron-forward-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

## Nomenclatura e Organização

### Convenções de Nomenclatura

```javascript
{
  "departamento.funcionalidade.acao": "marketing.leads.enviar-email",
  "sistema.integracao.processo": "crm.salesforce.sincronizar-contatos",
  "ambiente.tipo.workflow": "prod.vendas.processar-pedidos"
}
```

### Documentação de Workflows

```javascript
// Metadados para documentação
{
  "name": "Processar Pedidos de Venda",
  "description": "Workflow para processar pedidos vindos do e-commerce",
  "owner": "equipe-vendas@empresa.com",
  "tags": ["vendas", "e-commerce", "pedidos"],
  "version": "1.2.0",
  "lastUpdated": "2024-01-15T10:30:00Z",
  "dependencies": ["CRM", "Sistema de Pagamento"],
  "expectedExecutionTime": "5-10 minutos",
  "frequency": "Real-time via webhook"
}
```

---

<IonicIcon name="shield-checkmark-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

## Segurança

### Proteção de Dados Sensíveis

```javascript
// Configurações de segurança
{
  "security": {
    "maskSensitiveData": true,
    "logRetentionDays": 90,
    "requireMFA": true,
    "sessionTimeout": 3600,
    "maxLoginAttempts": 5,
    "passwordPolicy": {
      "minLength": 12,
      "requireUppercase": true,
      "requireLowercase": true,
      "requireNumbers": true,
      "requireSpecialChars": true
    }
  }
}
```

### Monitoramento de Performance

```javascript
// Métricas de monitoramento
{
  "monitoring": {
    "executionTime": {
      "warning": 300000, // 5 minutos
      "critical": 600000  // 10 minutos
    },
    "errorRate": {
      "warning": 0.05, // 5%
      "critical": 0.10  // 10%
    },
    "queueSize": {
      "warning": 100,
      "critical": 500
    }
  }
}
```

---

<IonicIcon name="arrow-forward-circle-outline" style={{fontSize: '24px', color: '#ea4b71'}} />

## Próximos passos

Agora que você entende o gerenciamento de workflows embarcados:

1. **[White Labelling](/embed/gerenciamento/white-labelling)** - Personalizar a aparência do n8n
2. **[Configuração do Embed](/embed/implementacao/configuracao)** - Configurar parâmetros avançados
3. **[Quickstart](/usando-n8n/getting-started/quickstart-rapido)** - Começar pela prática
4. **[Segurança](/hosting-n8n/seguranca/autenticacao)** - Implementar autenticação avançada

---

:::tip **Dica Pro**
Configure alertas automáticos para workflows críticos e mantenha backups regulares. Use a API para integrar o n8n com seus sistemas de monitoramento existentes.
:::

:::warning **Importante**
Sempre teste workflows em ambiente de desenvolvimento antes de aplicar em produção. Mantenha logs de auditoria por pelo menos 90 dias para compliance.
:::

:::info **Recurso Adicional**
Considere usar ferramentas de CI/CD para automatizar o deployment de workflows entre ambientes (dev, staging, prod).
:::

